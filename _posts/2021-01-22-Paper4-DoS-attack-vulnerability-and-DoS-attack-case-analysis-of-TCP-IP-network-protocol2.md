---
title: "학회지 논문 정리 : TCP/IP 네트워크 프로토콜의 DoS 공격 취약점 및 DoS 공격사례 분석 STEP 2"

categories:
  - Paper
tags: 
  - TCP/IP
  - Dos
  - DDos
  - DRDos
last_modified_at: 2021-01-22
---

이해하기에 너무 많은 정보들이라 차근 차근 업데이트 할 것

## TCP/IP 네트워크 프로토콜의 DoS 공격 취약점 및 DoS 공격사례 분석

> TCP/IP 네트워크 프로토콜의 DoS 공격 취약점 및 DoS 공격사례 분석

조성현, 이택규, 이선우. (2014). TCP/IP 네트워크 프로토콜의 DoS 공격 취약점 및 DoS 공격사례 분석. 정보보호학회지, 24(1), 45-52.
{: .small}

[TCP/IP 네트워크 프로토콜의 DoS 공격 취약점 및 DoS 공격사례 분석 STEP 1](https://jee00609.github.io/paper/Paper4-DoS-attack-vulnerability-and-DoS-attack-case-analysis-of-TCP-IP-network-protocol1/)

[TCP/IP 네트워크 프로토콜의 DoS 공격 취약점 및 DoS 공격사례 분석 STEP 2](https://jee00609.github.io/paper/Paper4-DoS-attack-vulnerability-and-DoS-attack-case-analysis-of-TCP-IP-network-protocol2/)

## 목차

   1. 서론
   2. DoS 공격 유형 분석
   3. **프로토콜 보안 취약점 분석**
   4. 대표적인 DoS 공격 사례
   5. 결론

## <span style="color:blue">프로토콜 보안 취약점 분석<span/>

TCP/IP 기반 네트워크 프로토콜들을 계층별로 나누어서 분석한다.

### 응용계층 프로토콜 보안 취약점 분석

| 프로토콜 |                                    DoS 공격                                   |
|:--------:|-----------------------------------------------------------------------------|
|   HTTP   | ① HTTP GET 플러딩 (HTTP Get Flooding), <br> ② HTTP CC 공격 (HTTP Cache-Control Attack) |
|    DNS   | DNS 증폭 DDoS 공격                                                            |
|   SMTP   | 메일 폭탄 (Mail Bomb)공격                                                     |
|    SIP   | SIP 플러딩 (SIP Flooding)                                                     |
|   SNMP   | SNMP DDoS 공격                                                                |

**HTTP 보안 취약점**

   * HTTP GET 플러딩 (HTTP Get Flooding)

|      이름      |                                                                            HTTP GET 플러딩 (HTTP Get Flooding)                                                                           |
|:--------------:|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|      정의      | TCP 3-way hand shaking 과정 이후 HTTP GET 요청을 주기적으로 수행하여 서버가 TCP 세션처리 뿐만 아니라 HTTP 요청작업까지 수행하도록 유도함으로써 서버의 리소스를 고갈시키는 공격의 한 종류 |
|      특징      | 변조되지 않은 IP로 정상적인 TCP 세션을 유지하고 HTTP GET 을 요청하여 특징을 찾아 필터링 하기 어렵다.                                                                                     |
|    1차 방어    | 공격 트래픽과 요청 주기 등을 분석해 IP를 차단하는 필터링 정책을 사용하기                                                                                                                 |
| 공격 방법 진화 | 필터링 정책보다도 낮은 트래픽과 주기를 갖고 수많은 좀비PC로 공격                                                                                                                         |
|    2차 방어    | HTTP GET 요청에 포함된 URL이 응답한 뒤에도 중복된 파일을 언급 시 필터링 하는 정책을 사용하기                                                                                             |

   * HTTP CC 공격 (HTTP Cache-Control Attack)

| 이름 |                                                    HTTP CC 공격 (HTTP Cache-Control Attack)                                                    |
|:----:|----------------------------------------------------------------------------------------------------------------------------------------------|
| 정의 | HTTP GET 플러딩 공격 시 HTTP의 헤더 값인 Cache-Control 값을 No-Cache로 설정하여 동일한 웹 페이지를 매번 새로운 페이지로 로드하는 방식의 공격법 |
| 특징 | HTTP GET 플러딩의 위력을 증폭시킬 수 있는 부가적인 공격방법                                                                                    |
| 방어 | 헤더의 Cache-Control 옵션 값을 체크하고 요청횟수에 대한 필터링을 적용하기                                                                      |

**DNS Query 취약점**

DNS 서버는 사용자의 PC의 요청에 따라 해당 도메인을 갖고 있는 IP 를 반환해 줌으로써 손쉽게 기억할 수 있는 도메인으로 서버에 접속할 수 있도록 도와주는 서버를 의미한다.

DNS 서버의 원리를 더 자세히 알고 싶다면 ['AWS DNS란 무엇입니까?'](https://aws.amazon.com/ko/route53/what-is-dns/)를 통해 이해하자.

공격자는 DNS Query 순서를 이용하여 공격하고자 하는 서버의 IP로 출발지를 변조한 뒤 DNS 서버에 다량의 좀비 PC 집단 (ZombiePC Network:Bot-Net)을 가지고 Query를 전송하여 그 응답이 모두 대상 서버에 집중되도록 한다.

이 공격법을 더 효율적으로 진화시켜 DRDoS 공격 방식이 만들어졌다.

| 이름 |                                                                                                                              DRDoS                                                                                                                              |
|:----:|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 정의 | RR (Resource Records)를 비정상적으로 큰 값으로 설정하여 기본 Query에 대한 응답 값이 훨씬 더 커지도록 유도하는 종류의 공격법                                                                                                                                     |
| 특징 | ① IP Spoofing 의 적극적인 사용 <br>② Reflector 의 사용                                                                                                                                                                                                              |
| 원인 | ① 서비스 팩이 적용되지 않은 windows XP를 사용하는 사용자들이 많이 있고 해당 운영체제를 포함한 다수의 이전 버전 운영체제들은 Row Socket을 사용하기 때문에 IP Spoofing에 사용된다. <br>② 중간에서 재귀적으로 Query를 전송하는 DNS 서버들이 리플렉터 역할을 하게 된다. |

**SMTP 자원 고갈 취약점**

| 이름 |                                                                                                       SMTP Mail Bomb 공격                                                                                                       |
|:----:|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 정의 | 메일서버에 동일하거나 유사한 메일을 자동적으로 생성하여 동시에 수백만 통을 보내 서버의 용량을 초과하게 만드는 공격                                                                                                              |
| 특징 | 정상적인 메일 송⋅수신을 방해                                                                                                                                                                                                    |
| 방어 | 공격자가 보낸 TCP 패킷을 분석하여 SMTP (25Port)를 확인한 후 데이터(571,550,501,554)를 확인하여 동일한 데이터를 보내는 메일의 횟수를 카운트해 필터링 하여 IP 주소를 차단하고 공격자에게 Reset 패킷을 보내어 방어하는 방법이 존재 |

* 데이터 숫자 의미
   * 571 (Unsolicited email refused)
   * 550 (Requested action not taken: mailbox unavailable)
   * 501 (Syntax error in parameters or argument)
   * 554 (Transaction failed)

**SIP 자원 고갈 취약점**

| 이름 |                                                      SIP 플러딩 공격                                                     |
|:----:|------------------------------------------------------------------------------------------------------------------------|
| 정의 | 공격자가 SIP 서버 및 사용자 에이전트에 SIP메시지를 대량으로 생성하여 전송하는 공격법                                     |
| 특징 | SIP 프로토콜은 TCP와 UDP 모두에 사용 될 수 있기 때문에 공격대상에게 리소스 고갈이나 대역폭 고갈을 모두 야기시킬 수 있다. |
| 방어 | 메시지 분석을 통해 중복되는 요청을 필터링 하고 해당 IP 주소를 차단하는 방법이 존재한다.                                  |

**SNMP 인증 (certification) 취약점**

| 이름 |                                                                        SNMP DDoS 공격                                                                       |
|:----:|-----------------------------------------------------------------------------------------------------------------------------------------------------------|
| 정의 | SNMP의 인증 취약점을 이용해 IP Spoofing 및 데이터 수정을 통해 DDoS 공격을 대상 시스템에 시도하는 공격법                                                     |
| 특징 | SNMP 프로토콜은 인터넷을 이용하는 기기들이라면 거의 다 지원하고 있어 더욱 더 거대한 Bot-Net을 구성해 공격할 수 있는 가능성을 내포하고 있기에 위험성이 크다. |
| 방어 | SNMP 서비스를 사용하지 않는다면 해당 프로토콜을 차단함으로써 예방이 가능하다.                                                                               |

### 전송계층 프로토콜 보안 취약점 분석

추후 업데이트

### 네트워크계층 프로토콜 보안 취약점 분석

추후 업데이트

## 비고

양이 너무 많아서 차근 차근 업데이트 할 것이다.

2021-01-22 : 솔직히 SNMP DDoS 공격에 대한 방어로 적힌 내용이 빈약?하다는 생각이 든다. 나중에 한번 방어법이 있는지 검색해보자.